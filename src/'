import React, { Component } from "react";
import { connect } from "react-redux";
import { match } from "single-key";

import { startReply } from "../actions";
import Comment from "../components/Comment";

@connect(({ entities, ui }, ownProps) => {
  const commentId = ownProps.id;
  const comment = entities[commentId];
  const reply = match(ui, {
    Idle() {
      return null;
    },
    AddingComment(reply) {
      const { parentId } = reply;
      if (parentId === commentId) {
        return reply;
      } 
      return null
    });
  });
  return { 
    comment
  };
}, {
  startReply
})
export default class CommentContainer extends Component {
  render() {
    const { comment, startReply } = this.props;
    const { kids } = comment;
    const childElements = kids.map(childId => {
      return <CommentContainer id={childId} key={childId} />;
    });
    const controlElement = 
    return (
      <Comment comment={comment} onReplyTo={startReply}>
        {childElements.length
          ? <div className="children-list">{childElements}</div>
          : null}
      </Comment>
    );
  }
}
